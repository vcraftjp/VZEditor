
｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣
		EZKEY Version 1.30  Copyright (C) 1989-92 by c.mos
			　　リファレンスマニュアル
｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣


			　	　目　次
		｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢
		１．EZKEYとは
		２．動作環境
		３．EZKEYの組み込み
		４．EZKEYのコマンド
		５．EZKEYのモードオプション
		６．サービス割り込み
		７．変更履歴
		８．配布条件
		｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢｢




■■■　１．EZKEYとは　■■■


　EZKEYは、メモリに常駐してキー入力割込み（int09h）をハンドルし、次のような
機能をサポートするツールです。

◎　[SHIFT]押下時の裏ファンクションキー表示
◎　[CTRL]+[GRPH]+[..]によるホットキー機能
◎　ブルーバック／ホワイトバック機能（アナログRGB使用）
◎　[CAPS],[ｶﾅ]キーロック状態の表示
◎　ＶZ Editor 上での [GRPH],[NFER],[CTRL]+[f･n]キーのサポート




■■■　２．動作環境　■■■


　EZKEYの動作環境は、次のとおりです。

ハードウェア：	ＰＣ－９８０１シリーズ全機種（ＬＴを除く）
		（Ver1.30から一部の機能を除いてハイレゾモードに対応します）

動作ＯＳ　　：	ＮＥＣ製ＭＳ－ＤＯＳ２．１１以降
		（一部の初期バージョンを除く）




■■■　３．EZKEYの組み込み　■■■


　EZKEYをメモリに常駐させる場合の書式は、次のとおりです。

	A>ezkey {-<オプション>[+|-]}
［例］
	A>ezkey -b3 -c -f-

取り外す時は、再度

	A>ezkey

を実行します。また、

	A>ezkey -?

で、<オプション>の一覧が表示されます。




■■■　４．EZKEYのコマンド　■■■


　EZKEY常駐時に実行できるコマンドを以下に説明します。コマンドは、

	[CTRL]+[GRPH]+[キー]

で実行します。これらのコマンドは、[キー]に対応する英字（記号）をコマンドライン
オプションとして指定することで、その機能を使えなくできます。

［例］
	A>ezkey -l-	（キーボードロック機能の抑止）

［書式］
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[キー]  タイトル  	-<標準設定>
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｇ] clear Graphic vram -g
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　グラフィックＶＲＡＭ（バンク０）を消去します。E0000h～E8000h の１６色表示用
ＶＲＡＭも含みます。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｔ] clear Text vram	-t
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　テキストＶＲＡＭ（ページ０）を消去します。文字の属性は、ＤＯＳの既定値で
初期化します。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｓ] Save text vram	-s （ノーマルモードのみ）
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　表（ページ０）テキストＶＲＡＭの内容を、裏（ページ１）テキストＶＲＡＭへ、
コピーします。後で参照したい画面を保存するときに使います。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｘ] eXchange text vram	-x（ノーマルモードのみ）
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　画面に表示するテキストＶＲＡＭを、表（ページ０）または裏（ページ１）とで
切り替えます。[Ｓ]で保存した画面を参照するときに使います。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｌ] Lock keyboard	-l
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　[CTRL]+[GRPH]+[L]を押すと、ビープ音が短く鳴り、キーボードをロックします。
再度[CTRL]+[GRPH]+[L]を押すと、ロックは解除されます。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｖ] reset crtV		-v
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　out 64h,al を実行し、ＣＲＴＶ割り込みを起動します。通常は使用しません。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[ＤＥＬ] reset cpu	-!
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　リセットします。（0FFFF:0000 にジャンプ）

★注意★　ＨＳＢ等の高速リブートユーティリティをお使いの場合は、
	「-!-」を指定してこの機能を抑止してください。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｉ] Interrupt		-i
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　ＩＮＴ３を発生し、symdeb等の上で実行中のプログラムをブレークします。
通常は使用してはなりません。




■■■　５．EZKEYのモードオプション　■■■


　EZKEY常駐時に使えるその他の機能について説明します。以下の機能は、最初に述べた
ように起動時のコマンドラインでモードで指定できますが、

	[CTRL]+[GRPH]+[オプション]
	
を入力することでいつでもＯＮ／ＯＦＦを切り替えることができます。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｄ] Display graphic vram  -i-
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　グラフィックＶＲＡＭの表示／非表示を切り替えます。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ａ] Analog/digital mode   -a- （ノーマルモードのみ）
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　グラフィックのデジタル／アナログＲＧＢモードを切り替えます。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｂ] Blue back		   -b- (4)
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　アナログＲＧＢで、青の背景色を表示します。数値は 0～7 で明るさを指定します。
標準設定の明るさは 4 です。
[CTRL]+[GRPH]+[B]で、表示のＯＮ／ＯＦＦを切り替えます。

［例］
	A>ezkey -b	（明るさは4）
	A>ezkey -b7	（明るさは7）

ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｗ] White back		   -w- (4)
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　アナログＲＧＢで、グレーの背景色を表示します。それ以外は［Ｂ］と同じです。
この時、ＶZ Editorを -an0 オプションで起動すると、白地に黒文字で編集できます。

ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｒ] type caps for RA,RX   -r5
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　[CAPS]または[ｶﾅ]キーがロックされていると、画面最下行のファンクションキー
の右端に "CAPS" または " ｶﾅ " を表示します。数値は 1～7 の表示色を指定します。
標準設定の表示色は 5（水色）です。

［例］
	A>ezkey -r6	（黄色で表示）
	A>ezkey -r-	（[CAPS],[ｶﾅ]の表示をしない）

★注意★　フロントエンドプロセッサがＯＮの状態では、表示されません。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｃ] Click sound	   -c- (4)
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　キー入力時にクリック音を発生します。数値は 0～7 で、音の長さを指定します。
標準設定の音長は 4 です。これは、ＣＰＵの速度に影響されます。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｆ] shift Function key	   -f+ -f2,4,6
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　[SHIFT]キーを押している間、裏ファンクションキー（f･11～f･20）の内容を表示し
ます。
　ファンクションキーを独自に表示しているアプリケーション下で、この機能が動作
してしまうと、表示が乱れる場合があります。このような時は、下記のように数値を
指定してください。

-f2	ＶＺ動作中のみこの機能をＯＮします。
-f4	ファンクションキーの色が「白」の時のみ、裏ファンクションキーの表示
	を行います。
	この指定は、テキスト画面分割をしないでＦＥＰのガイドライン表示を
	行なっている際に有効です。
-f6	ＶＺ動作中で、なおかつファンクションキーの色が「白」の時のみ、
	裏ファンクションキーの表示を行います。

★注意★　エプソンＤＯＳ、日電ＯＳ／２では使用できません。




ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[￥] ` character	   -\-
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　[SHIFT]+[^]でバッククォート文字［`］を入力します。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[＠] activate [GRPH] key   -@+ -@2    ※
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　ＶZ Editor 上で、[GRPH]+[英字]コマンド、および [GRPH]+[テンキー]による
全角記号の入力を可能にします。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｎ] activate [NFER] key   -N+	　　　※
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　ＶZ Editor 上で、[NFER]キーを使用可能にします。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[＾] activate [CTRL]+[f･n] key -^- 　 ※
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
　ＶZ Editor 上で、[CTRL]+[f･n]キーを使用可能にします。
日電製ＭＳ-ＤＯＳ３.３以上のもとでは、このオプションを指定せずとも
ＶＺで「FK+」に設定すれば、[CTRL]+[f･n]キーが使えます。


※　一般に、ＦＥＰで漢字入力モードがＯＮになっている時は、これらの変換機能は
　動作しません。
　ただし、ＷＸⅡでは、WXK.SYSに「/EZ」オプションを指定し、EZKEYで「-@2」を指定
　すると、ＷＸIIがＯＮの状態（未入力状態）でも、[GRPH]キーが使えます。


ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ
[Ｋ] mask [カナ],[CAPS]key
ｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧｧ

[カナ]キー、および[CAPS]キーを無効にします。ＲＡ以降のソフトキーロックの
キーボードでのみ有効です。また、無効にしてもＬＥＤは点灯します。

-K1	[カナ]ロックを無効にします。
-K2	[CAPS]ロックを無効にします。
-K3	[カナ],[CAPS]ロックを無効にします。




■■■　６．サービス割り込み　■■■

　EZKEY Version 1.10 から、サービス割り込み（INT E0h）をサポートしました。
この割り込みを使うと、外部プログラムから、[CTRL]+[GRPH]+[..]のキーが押された時
と同様の機能を実行することができます。


●割り込み番号	Ｅ０ｈ

●識別方法

　Ｅ０ｈ割り込みベクタアドレスの直前の２バイトが、文字列 "EZ" かどうか。

［例］
	mov	ax,35E0h
	int	21h
	cmp	word ptr es:[bx-2],'ZE'

●コール方法
　ＡＨにファンクション番号をセットして、ｉｎｔ　Ｅ０ｈ割り込みを実行します。
ＡＸ及び返り値として使用されるレジスタ以外の全てのレジスタは、保存されます。

●ファンクション仕様

■ＡＨ＝０　コマンドの実行

→ＡＬ	：コマンドシンボル
　ＤＬ	：パラメータ
	　０＝ＯＦＦ
	　１～７＝ＯＮ
	　－１＝反転（キーが押された時と同様）
	　－２＝ＧＥＴ
←ＡＬ	：現在のパラメータ

［例］
	mov	ax,'B'			; ブルーバック表示
	mov	dl,4			; 明るさ４
	int	0E0h

■ＡＨ＝１　内部ステータスバイトの取得

←ＡＬ	：内部ステータスバイト

■ＡＨ＝２　内部ステータスバイトのセット

→ＡＬ	：内部ステータスバイト

■ＡＨ＝４　外部ホットキー処理ルーチンのセット

→ＥＳ：ＢＸ　：設定するホットキー処理ルーチンのポインタ
←ＥＳ：ＢＸ　：前に設定されていた処理ルーチンのポインタ

　処理ルーチンでは、ＡＸのキーコードをチェックし、処理すべきキーならば対応する
ルーチンを実行し、ｒｅｔｆで終了します。それ以外のキーならば、前に設定されて
いた処理ルーチンへｊｍｐ　ｆａｒします。




■■■　７．変更履歴　■■■

（Ver1.20以降）

Ver1.23		-f2 でＶＺ上でのみ裏ﾌｧﾝｸｼｮﾝｷｰ表示
Ver1.24		[GRPH]+[英字],[ﾃﾝｷｰ]入力を、エプソン機に対応
		EZKEY解放時にデジタルモードに設定
		EZKEY解放時にINT09hベクタのチェック
Ver1.25		裏ﾌｧﾝｸｼｮﾝｷｰ表示のＤＯＳ３.３Ｃ対応
Ver1.26		ＷＸＰ、松茸2.13のＯＮ／ＯＦＦ判定対応
Ver1.27		-k1,2,3 で[ｶﾅ],[CAPS]マスク
		-b0 で背景色がつかないバグを修正
Ver1.28		-f4 でﾌｧﾝｸｼｮﾝｷｰが白の時のみ裏ﾌｧﾝｸｼｮﾝｷｰ表示
		-@2 でＷＸIIＯＮ時の[GRPH]+[英字],[ﾃﾝｷｰ]入力
Ver1.29		-k? で[ｶﾅ],[CAPS]マスクとthelpとの共存
Ver1.30		ハイレゾモード対応
		EZKEY解放時、バックカラーＯＦＦ時のデジタルモード設定を廃止




■■■　８．配布条件　■■■

・本プログラムはフリー・ソフトウェアです。転載・再配布は自由ですが、改変を
　施した場合の再配布は禁じます。
・雑誌、市販製品への添付も自由ですが、その場合は必ず作者へご一報ください。
・本プログラムソースコードは、「ＶＺエディタＶｅｒ１.５７、ソースアップデート
　キット」に含まれます。ソースファイルの取り扱い規約は、そちらのドキュメントを
　参照してください。


							91/1/8 兵藤嘉彦
							日経ＭＩＸ c.mos
｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣
				End of ezkey.doc
｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣｣
