======== game.def (v1.6) ========

#if 0

  A>vz +game ...

  --- 98 ---  --- IBM ---
  CTRL+HELP   Ctrl+F11		:start
  [4]	      [©],[J]		:left
  [6]	      [¨],[L]		:right
  [5]	      [ª],[K]		:rotate
  [SPACE]     [«],[Space]	:shoot
  [ESC]				:pause
  [Q]				:panic!

#endif

* Macros

#if 98 J31
80 ^[HELP] "Game"
#else
80 ^[F11] "Game"
#endif
	(s)? /
	ax=$2C00, &i($21) rn=cx+dx,	; “ú•t¥ŠÔ‚Årandomize
	(wt)? { #Y >^ }
	(mb)? #b
	mr[, mi[-, ei[+, es[-, wl[=12, as[, ab[, aw[, dc[-, du[-,
	UU=10, u=20-UU/2, BB=10, f=g=0,
#if 98
	as=9, ab=10, aw=5,
#else
	as=ao, ab=aw=ar,
#endif
	>20

1:	(c)?{ &o(c) #s . }
	(cd!='@')?{ e+, &q }

10:	e-, &01 (t)>?{ >+1 >+2 >+3 >+4 >+5 >+6 >+7 }

11:	#d &01 #e &01 #s &01 #x
12:	(d&1)?{ #s &01 #d #d &01 #d &01 #s #s .}
		#x &01 #e #e &01 #e &01 #x #x
13:	(d&1)?{ #d &01 #s #e &01 #s &01 #x #d .}
		#e &01 #d &01 #e &01 #x #s #x
14:	(d&1)?{ #d &01 #s #x &01 #s &01 #d #e .}
		#e &01 #x #d &01 #x &01 #e #s
15:	(d!=0)?{ #d &01 #s } (d!=1)?{ #e &01 #x }
	(d!=2)?{ #s &01 #d } (d!=3)?{ #x &01 #e }
16:	#d (d&1)?? &01 #e (d==0)? &01 #s (d&1)? &01 #s (d==1)? &01
	#x (d&1)?? &01 #x (d==2)? &01 #d (d&1)? &01 #d (d==3)? &01 #e #s
17:	#d (d&1)?? &01 #e (d==3)? &01 #s (d&1)? &01 #s (d==0)? &01
	#x (d&1)?? &01 #x (d==1)? &01 #d (d&1)? &01 #d (d==2)? &01 #e #s

20:	&s #39 #n #18
	(u*2-2){' '}
	'„¬' (UU){'„ª'} '„­' #m
	'„«' (UU){'@'} '„«' #m
	'„¯' (UU){'„ª'} '„®'
	&d #e #k (wy-5){ #p } #i mi+, >>

21:	vv=40-f/2, (vv<BB)? (vv=BB)
	&m( "Best score %-5u Score %-5u Delay %-5u", h, g, vv ) >>

22:	&s x=u+4, &y(y=4) &x(x*2)
	&r t=r%7, &r d=r&3,
	(c-)&10 (e)?{ (c=' ')&10 >30 } >>

23:	v=vv, >>

24:	xx=yy=dd=0,
	(c=' ')&10 &d &s
:A	&k &u(r) k=r,
	(k==$1B)?{ &d !02 &s >A }
	(v<0)? >>
	(v--)??{ &b(1) >> }
	(k)??{ &w(1) >A }
#if 98
	&f(k,"Q645 ")
	(r)>?{ >40 (xx+) (xx--) (dd+) { v=-1, &b(2) >> } }
#else
	(k==$4D00||k=='L')? xx+,
	(k==$4B00||k=='J')? xx--,
	(k==$4800||k=='K')? dd+,
	(k==$5000||k==' ')?{ v=-1, &b(2) >> }
	(k=='Q')? >40
#endif
	>+2

25:	yy+,>>
26:	(v>0)?{ v-=4, (v<1)? (v=1) }
	(c='@')&10
	(yy)?{ &y(y+=yy) }
	(xx)?{ x+=xx, &x(x*2) }
	d=(d+dd)&3,
	(c-)&10 (e)??{ (v)? >-2 >-3 }
	&y(y-=yy)
	x-=xx, &x(x*2)
	d=(d-dd)&3,
	(yy)?? >-3

	(c='¡')&10 &d &s
	&y(y=2)
:Y	&x(u*2) (x=UU)
:X	(cd=='¡')?{ #d (x--)? >X &x(u*2) (UU){'™'} }
	#x (y++<wy-2)? >Y &d
	&s ff-, &y(y=2) &x(u*2)
:Z	(cd=='™')?{
		#y &y(1) #k #i &y(y) g++,ff+, &d &s
		&b(2) &w(1) &b(2) &w(8)
	}
	#x (y++<wy-2)? >Z
	&d (ff)? (f++) >21

30:	(g>h)? (h=g)
	f=g=0,
	&d
	&b(4) &w(8) &b(16)
	!01 (r==-1)? >>
	#39 #x #k (wy-3){ #p } &s #40 (wy-3){ #y } &d >21

40:	&d #39 #x (wy-2){ #y } #e #y
	du], dc], aw], ab], as], wl], es], ei], mi], mr], #]

* Pop up menu

1	"",22,1,0,-1
	" ‚f‚`‚l‚d  ‚n‚u‚d‚q "

2	"",14,1,0,-1
	" ‚o‚`‚t‚r‚d "

;======== End of game.def ========
